<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskLoom - Monthly Task Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .calendar-day {
            min-height: 120px;
            transition: all 0.3s ease;
        }
        
        .calendar-day:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .task-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: inline-block;
            margin: 1px;
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .pastel-bg {
            background: linear-gradient(135deg, #fef7ff 0%, #f0f9ff 50%, #f0fff4 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.8);
        }
        
        /* Dark mode styles */
        .dark {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        
        .dark .glass-effect {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(71, 85, 105, 0.3);
        }
        
        .dark .calendar-day {
            background: rgba(30, 41, 59, 0.6);
            border-color: rgba(71, 85, 105, 0.5);
            color: #e2e8f0;
        }
        
        .dark .calendar-day:hover {
            background: rgba(30, 41, 59, 0.8);
            border-color: rgba(139, 92, 246, 0.5);
        }
        
        .dark .bg-white {
            background: rgba(30, 41, 59, 0.6) !important;
            color: #e2e8f0;
        }
        
        .dark .text-gray-700 {
            color: #e2e8f0 !important;
        }
        
        .dark .text-gray-600 {
            color: #cbd5e1 !important;
        }
        
        .dark .text-gray-500 {
            color: #94a3b8 !important;
        }
        
        .dark .border-gray-200 {
            border-color: rgba(71, 85, 105, 0.5) !important;
        }
        
        .dark input, .dark select, .dark textarea {
            background: rgba(30, 41, 59, 0.8) !important;
            border-color: rgba(71, 85, 105, 0.5) !important;
            color: #e2e8f0 !important;
        }
        
        .dark input:focus, .dark select:focus, .dark textarea:focus {
            border-color: rgba(139, 92, 246, 0.5) !important;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1) !important;
        }
        
        .daily-filter-btn {
            background: rgba(255, 255, 255, 0.7);
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }
        
        .daily-filter-btn:hover {
            background: rgba(255, 255, 255, 0.9);
            color: #374151;
        }
        
        .daily-filter-btn.active {
            background: linear-gradient(135deg, #ec4899, #f472b6);
            color: white;
            border-color: #ec4899;
        }
        
        .main-filter-btn {
            background: rgba(255, 255, 255, 0.7);
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }
        
        .main-filter-btn:hover {
            background: rgba(255, 255, 255, 0.9);
            color: #374151;
        }
        
        .main-filter-btn.active {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
            border-color: #8b5cf6;
        }
    </style>
</head>
<body class="pastel-bg min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent mb-2">
                üóìÔ∏è TaskLoom
            </h1>
            <p class="text-gray-600">Weave your tasks into perfect productivity</p>
        </div>

        <!-- Google Sync & Controls -->
        <div class="glass-effect rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex flex-col lg:flex-row justify-between items-center gap-4">
                <!-- Left Section: Google Account -->
                <div class="flex items-center gap-4">
                    <button id="googleSignIn" onclick="signIn()" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-xl transition-all duration-200 shadow-md flex items-center gap-2">
                        <svg class="w-5 h-5" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        Connect Google
                    </button>
                    
                    <!-- User Profile (Hidden by default) -->
                    <div id="userInfo" class="hidden flex items-center gap-3 bg-white bg-opacity-60 rounded-xl p-3 border border-green-200">
                        <img id="userPhoto" class="w-12 h-12 rounded-full border-2 border-green-300 shadow-md" alt="User">
                        <div class="flex-1">
                            <div id="userName" class="font-semibold text-gray-800 text-sm"></div>
                            <div id="userEmail" class="text-xs text-gray-600 mb-1"></div>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-green-600 font-medium">üü¢ Connected</span>
                                <button onclick="syncWithGoogle()" class="text-xs text-blue-500 hover:text-blue-700 font-medium" title="Manual sync">
                                    üîÑ Sync
                                </button>
                                <button onclick="signOut()" class="text-xs text-red-500 hover:text-red-700 font-medium">
                                    üö™ Sign Out
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Center Section: Month Navigation -->
                <div class="flex items-center gap-4">
                    <button onclick="previousMonth()" class="p-3 bg-gradient-to-r from-purple-200 to-purple-300 hover:from-purple-300 hover:to-purple-400 text-purple-700 rounded-xl transition-all duration-200">
                        ‚Üê Previous
                    </button>
                    <h2 id="currentMonth" class="text-2xl font-bold text-gray-700 min-w-[200px] text-center"></h2>
                    <button onclick="nextMonth()" class="p-3 bg-gradient-to-r from-purple-200 to-purple-300 hover:from-purple-300 hover:to-purple-400 text-purple-700 rounded-xl transition-all duration-200">
                        Next ‚Üí
                    </button>
                </div>
                
                <!-- Right Section: Controls -->
                <div class="flex items-center gap-3">
                    <!-- Data Management -->
                    <div class="flex items-center gap-2">
                        <button onclick="exportData()" class="p-3 bg-gradient-to-r from-green-400 to-green-500 hover:from-green-500 hover:to-green-600 text-white rounded-xl transition-all duration-200 shadow-md" title="Export Data">
                            üì§
                        </button>
                        <input type="file" id="importFile" accept=".json" onchange="importData()" class="hidden">
                        <button onclick="document.getElementById('importFile').click()" class="p-3 bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white rounded-xl transition-all duration-200 shadow-md" title="Import Data">
                            üì•
                        </button>
                    </div>
                    
                    <!-- Theme Toggle -->
                    <button onclick="toggleTheme()" id="themeToggle" class="p-3 bg-gradient-to-r from-indigo-400 to-indigo-500 hover:from-indigo-500 hover:to-indigo-600 text-white rounded-xl transition-all duration-200 shadow-md" title="Toggle Dark Mode">
                        üåô
                    </button>
                    
                    <!-- Settings -->
                    <button onclick="toggleSettings()" class="p-3 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white rounded-xl transition-all duration-200 shadow-md" title="Settings">
                        ‚öôÔ∏è
                    </button>
                </div>
            </div>
        </div>

        <!-- Monthly Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="glass-effect rounded-xl p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-pink-400" id="monthlyTotal">0</div>
                <div class="text-sm text-gray-600">Total Tasks</div>
            </div>
            <div class="glass-effect rounded-xl p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-green-400" id="monthlyCompleted">0</div>
                <div class="text-sm text-gray-600">Completed</div>
            </div>
            <div class="glass-effect rounded-xl p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-blue-400" id="activeDays">0</div>
                <div class="text-sm text-gray-600">Active Days</div>
            </div>
            <div class="glass-effect rounded-xl p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-purple-400" id="completionRate">0%</div>
                <div class="text-sm text-gray-600">Progress</div>
            </div>
        </div>

        <!-- Main Task Management Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Add Task Panel -->
            <div class="glass-effect rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-700 mb-4">‚ûï Add New Task</h3>
                <div class="space-y-4">
                    <input 
                        type="text" 
                        id="mainTaskInput" 
                        placeholder="Enter your task..." 
                        class="w-full px-4 py-3 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-transparent outline-none"
                        maxlength="100"
                    >
                    <select id="mainTaskPriority" class="w-full px-4 py-3 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-transparent outline-none text-gray-700">
                        <option value="low">üü¢ Low Priority</option>
                        <option value="medium">üü° Medium Priority</option>
                        <option value="high">üî¥ High Priority</option>
                    </select>
                    <input 
                        type="date" 
                        id="mainTaskDate" 
                        class="w-full px-4 py-3 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-transparent outline-none"
                    >
                    <button onclick="addMainTask()" class="w-full px-4 py-3 bg-gradient-to-r from-pink-400 to-purple-400 hover:from-pink-500 hover:to-purple-500 text-white font-medium rounded-lg transition-all duration-200 shadow-md">
                        Add Task
                    </button>
                </div>
            </div>

            <!-- Task Statistics -->
            <div class="glass-effect rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-700 mb-4">üìä Task Overview</h3>
                <div class="space-y-4">
                    <div class="flex justify-between items-center p-3 bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg">
                        <span class="text-gray-700 font-medium">Total Tasks</span>
                        <span class="text-2xl font-bold text-purple-600" id="mainTotalTasks">0</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg">
                        <span class="text-gray-700 font-medium">Pending</span>
                        <span class="text-2xl font-bold text-orange-600" id="mainPendingTasks">0</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gradient-to-r from-green-50 to-green-100 rounded-lg">
                        <span class="text-gray-700 font-medium">Completed</span>
                        <span class="text-2xl font-bold text-green-600" id="mainCompletedTasks">0</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg">
                        <span class="text-gray-700 font-medium">Progress</span>
                        <span class="text-2xl font-bold text-blue-600" id="mainProgressRate">0%</span>
                    </div>
                </div>
            </div>

            <!-- Monthly To-Do List -->
            <div class="glass-effect rounded-2xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-700 mb-4">üìÖ Monthly To-Do</h3>
                
                <!-- Add Monthly Task -->
                <div class="mb-4">
                    <div class="flex gap-2">
                        <input 
                            type="text" 
                            id="monthlyTaskInput" 
                            placeholder="Add monthly task..." 
                            class="flex-1 px-3 py-2 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-transparent outline-none text-sm"
                            maxlength="60"
                        >
                        <button onclick="addMonthlyTask()" class="px-3 py-2 bg-gradient-to-r from-pink-300 to-pink-400 hover:from-pink-400 hover:to-pink-500 text-white rounded-lg transition-all duration-200 text-sm">
                            ‚ûï
                        </button>
                    </div>
                </div>
                
                <!-- Monthly Tasks List -->
                <div class="space-y-2 max-h-64 overflow-y-auto" id="monthlyTodoList">
                    <!-- Monthly tasks will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Task List Section -->
        <div class="glass-effect rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                <h3 class="text-2xl font-bold text-gray-700">üìã Task List</h3>
                
                <!-- Task Filters -->
                <div class="flex flex-wrap gap-2">
                    <button onclick="filterMainTasks('all')" class="main-filter-btn active px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">All Tasks</button>
                    <button onclick="filterMainTasks('pending')" class="main-filter-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">Pending</button>
                    <button onclick="filterMainTasks('completed')" class="main-filter-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">Completed</button>
                    <button onclick="filterMainTasks('high')" class="main-filter-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">üî¥ High</button>
                    <button onclick="filterMainTasks('medium')" class="main-filter-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">üü° Medium</button>
                    <button onclick="filterMainTasks('low')" class="main-filter-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">üü¢ Low</button>
                    <button onclick="filterMainTasks('today')" class="main-filter-btn px-4 py-2 rounded-full text-sm font-medium transition-all duration-200">üìÖ Today</button>
                </div>
            </div>
            
            <!-- Tasks Container -->
            <div id="mainTasksList" class="space-y-3">
                <!-- Main tasks will be rendered here -->
            </div>
        </div>

        <!-- Calendar -->
        <div class="glass-effect rounded-2xl shadow-lg p-6 mb-6">
            <!-- Days of week header -->
            <div class="grid grid-cols-7 gap-2 mb-4">
                <div class="text-center font-semibold text-gray-600 py-2">Sun</div>
                <div class="text-center font-semibold text-gray-600 py-2">Mon</div>
                <div class="text-center font-semibold text-gray-600 py-2">Tue</div>
                <div class="text-center font-semibold text-gray-600 py-2">Wed</div>
                <div class="text-center font-semibold text-gray-600 py-2">Thu</div>
                <div class="text-center font-semibold text-gray-600 py-2">Fri</div>
                <div class="text-center font-semibold text-gray-600 py-2">Sat</div>
            </div>
            
            <!-- Calendar grid -->
            <div id="calendarGrid" class="grid grid-cols-7 gap-2">
                <!-- Calendar days will be generated here -->
            </div>
        </div>

        <!-- Help Button -->
        <div class="fixed bottom-6 right-6 z-40">
            <button onclick="toggleHelpPanel()" id="helpButton" class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white p-4 rounded-full shadow-lg transition-all duration-200 hover:scale-110">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
            </button>
        </div>

        <!-- Settings Panel -->
        <div id="settingsPanel" class="fixed top-0 right-0 w-96 h-full bg-white shadow-2xl border-l-4 border-purple-500 transform translate-x-full transition-transform duration-300 z-50 overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                        ‚öôÔ∏è TaskLoom Settings
                    </h2>
                    <button onclick="toggleSettings()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
                </div>

                <!-- Theme Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2">
                        üé® Appearance
                    </h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                            <div>
                                <div class="font-medium text-gray-700">Dark Mode</div>
                                <div class="text-sm text-gray-500">Switch between light and dark themes</div>
                            </div>
                            <button onclick="toggleTheme()" id="themeToggleSwitch" class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                                <span id="themeToggleIndicator" class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform translate-x-1"></span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Data Management -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2">
                        üíæ Data Management
                    </h3>
                    <div class="space-y-3">
                        <button onclick="exportData()" class="w-full flex items-center gap-3 p-4 bg-green-50 hover:bg-green-100 rounded-xl transition-colors duration-200 border border-green-200">
                            <span class="text-2xl">üì§</span>
                            <div class="text-left">
                                <div class="font-medium text-green-700">Export Data</div>
                                <div class="text-sm text-green-600">Download your tasks as JSON file</div>
                            </div>
                        </button>
                        
                        <button onclick="document.getElementById('importFile').click()" class="w-full flex items-center gap-3 p-4 bg-orange-50 hover:bg-orange-100 rounded-xl transition-colors duration-200 border border-orange-200">
                            <span class="text-2xl">üì•</span>
                            <div class="text-left">
                                <div class="font-medium text-orange-700">Import Data</div>
                                <div class="text-sm text-orange-600">Upload tasks from JSON file</div>
                            </div>
                        </button>
                        
                        <button onclick="clearAllData()" class="w-full flex items-center gap-3 p-4 bg-red-50 hover:bg-red-100 rounded-xl transition-colors duration-200 border border-red-200">
                            <span class="text-2xl">üóëÔ∏è</span>
                            <div class="text-left">
                                <div class="font-medium text-red-700">Clear All Data</div>
                                <div class="text-sm text-red-600">Delete all tasks and reset app</div>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- Google Drive Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2">
                        ‚òÅÔ∏è Google Drive Sync
                    </h3>
                    <div class="space-y-3">
                        <div id="googleStatus" class="p-4 bg-gray-50 rounded-xl border border-gray-200">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">‚ùå</span>
                                <div>
                                    <div class="font-medium text-gray-700">Not Connected</div>
                                    <div class="text-sm text-gray-500">Connect to sync across devices</div>
                                </div>
                            </div>
                        </div>
                        
                        <button onclick="toggleHelpPanel()" class="w-full flex items-center gap-3 p-4 bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors duration-200 border border-blue-200">
                            <span class="text-2xl">üìñ</span>
                            <div class="text-left">
                                <div class="font-medium text-blue-700">Setup Instructions</div>
                                <div class="text-sm text-blue-600">Learn how to connect Google Drive</div>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- App Information -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2">
                        ‚ÑπÔ∏è About
                    </h3>
                    <div class="space-y-3">
                        <div class="p-4 bg-gray-50 rounded-xl border border-gray-200">
                            <div class="text-sm text-gray-600 space-y-2">
                                <div><strong>Version:</strong> 2.0.0</div>
                                <div><strong>Last Updated:</strong> <span id="lastSyncTime">Never</span></div>
                                <div><strong>Storage:</strong> <span id="storageInfo">Local Browser</span></div>
                                <div><strong>Total Tasks:</strong> <span id="totalTasksCount">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2">
                        ‚ö° Quick Actions
                    </h3>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="goToToday()" class="p-3 bg-purple-50 hover:bg-purple-100 rounded-xl transition-colors duration-200 border border-purple-200 text-center">
                            <div class="text-xl mb-1">üìÖ</div>
                            <div class="text-sm font-medium text-purple-700">Go to Today</div>
                        </button>
                        
                        <button onclick="showStats()" class="p-3 bg-indigo-50 hover:bg-indigo-100 rounded-xl transition-colors duration-200 border border-indigo-200 text-center">
                            <div class="text-xl mb-1">üìä</div>
                            <div class="text-sm font-medium text-indigo-700">View Stats</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Help Panel -->
        <div id="helpPanel" class="fixed bottom-0 left-0 right-0 bg-white shadow-2xl border-t-4 border-blue-500 transform translate-y-full transition-transform duration-300 z-50 max-h-[80vh] overflow-y-auto">
            <div class="container mx-auto px-6 py-6 max-w-4xl">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                        üîß TaskLoom - Google Drive Setup Instructions
                    </h2>
                    <button onclick="toggleHelpPanel()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Quick Start -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200">
                        <h3 class="text-xl font-bold text-green-800 mb-4 flex items-center gap-2">
                            üöÄ Quick Start Guide
                        </h3>
                        <div class="space-y-3 text-sm text-green-700">
                            <div class="flex items-start gap-3">
                                <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</span>
                                <div>
                                    <strong>Go to Google Cloud Console:</strong><br>
                                    <a href="https://console.cloud.google.com" target="_blank" class="text-blue-600 hover:underline">console.cloud.google.com</a>
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</span>
                                <div>
                                    <strong>Create a new project</strong> or select existing one
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</span>
                                <div>
                                    <strong>Enable Google Drive API</strong> in the API Library
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">4</span>
                                <div>
                                    <strong>Create credentials</strong> (OAuth 2.0 Client ID)
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">5</span>
                                <div>
                                    <strong>Replace the demo credentials</strong> in the code
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Steps -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200">
                        <h3 class="text-xl font-bold text-blue-800 mb-4 flex items-center gap-2">
                            üìã Detailed Steps
                        </h3>
                        <div class="space-y-4 text-sm text-blue-700">
                            <div>
                                <h4 class="font-semibold mb-2">üèóÔ∏è Project Setup:</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>Sign in to Google Cloud Console</li>
                                    <li>Click "Select a project" ‚Üí "New Project"</li>
                                    <li>Name your project (e.g., "TaskLoom App")</li>
                                    <li>Click "Create"</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">üîå Enable API:</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>Go to "APIs & Services" ‚Üí "Library"</li>
                                    <li>Search for "Google Drive API"</li>
                                    <li>Click on it and press "Enable"</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">üîë Create Credentials:</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>Go to "APIs & Services" ‚Üí "Credentials"</li>
                                    <li>Click "Create Credentials" ‚Üí "OAuth client ID"</li>
                                    <li>Choose "Web application"</li>
                                    <li>Add your domain to authorized origins</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- OAuth Setup -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 border border-purple-200">
                        <h3 class="text-xl font-bold text-purple-800 mb-4 flex items-center gap-2">
                            üîê OAuth Consent Screen
                        </h3>
                        <div class="space-y-3 text-sm text-purple-700">
                            <p><strong>Before creating credentials, set up OAuth consent:</strong></p>
                            <ul class="list-disc list-inside space-y-1 ml-4">
                                <li>Go to "OAuth consent screen"</li>
                                <li>Choose "External" for public use</li>
                                <li>Fill in app name and user support email</li>
                                <li>Add your email to developer contact info</li>
                                <li>Add scopes: <code class="bg-purple-200 px-1 rounded">../auth/drive.file</code></li>
                                <li>Add test users (including yourself)</li>
                                <li>Save and continue</li>
                            </ul>
                            <div class="bg-purple-200 p-3 rounded-lg mt-3">
                                <p class="font-semibold">üí° Pro Tip:</p>
                                <p>For testing, you can keep the app in "Testing" mode and add specific Gmail accounts as test users.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Code Integration -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-6 border border-orange-200">
                        <h3 class="text-xl font-bold text-orange-800 mb-4 flex items-center gap-2">
                            üíª Code Integration
                        </h3>
                        <div class="space-y-3 text-sm text-orange-700">
                            <p><strong>Replace these values in the JavaScript code:</strong></p>
                            <div class="bg-gray-800 text-green-400 p-3 rounded-lg font-mono text-xs overflow-x-auto">
                                <div>const CLIENT_ID = 'your-client-id.apps.googleusercontent.com';</div>
                                <div>const API_KEY = 'your-api-key';</div>
                            </div>
                            <div class="space-y-2">
                                <p><strong>üîç Where to find these:</strong></p>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li><strong>Client ID:</strong> In "Credentials" tab, under "OAuth 2.0 Client IDs"</li>
                                    <li><strong>API Key:</strong> In "Credentials" tab, under "API Keys" (create if needed)</li>
                                </ul>
                            </div>
                            <div class="bg-orange-200 p-3 rounded-lg">
                                <p class="font-semibold">‚ö†Ô∏è Security Note:</p>
                                <p>For production apps, restrict your API key to specific domains and enable application restrictions.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Troubleshooting -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-6 border border-red-200 lg:col-span-2">
                        <h3 class="text-xl font-bold text-red-800 mb-4 flex items-center gap-2">
                            üîß Common Issues & Solutions
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-red-700">
                            <div>
                                <h4 class="font-semibold mb-2">‚ùå "Google Drive Unavailable"</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>Check if API credentials are correctly set</li>
                                    <li>Verify Google Drive API is enabled</li>
                                    <li>Ensure domain is in authorized origins</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">‚ùå "Sign in failed"</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>Check OAuth consent screen setup</li>
                                    <li>Add your email as a test user</li>
                                    <li>Verify redirect URIs are correct</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">‚ùå "Sync failed"</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>Check internet connection</li>
                                    <li>Verify Drive API permissions</li>
                                    <li>Try signing out and back in</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">‚ùå "Access blocked"</h4>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li>App needs verification for public use</li>
                                    <li>Use "Testing" mode for personal use</li>
                                    <li>Add users to test user list</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Benefits -->
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-xl p-6 border border-indigo-200 lg:col-span-2">
                        <h3 class="text-xl font-bold text-indigo-800 mb-4 flex items-center gap-2">
                            ‚ú® Benefits of Google Drive Sync
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-indigo-700">
                            <div class="text-center">
                                <div class="text-3xl mb-2">‚òÅÔ∏è</div>
                                <h4 class="font-semibold mb-1">Cloud Backup</h4>
                                <p>Your tasks are safely stored in Google Drive and won't be lost if you clear browser data.</p>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl mb-2">üîÑ</div>
                                <h4 class="font-semibold mb-1">Multi-Device Sync</h4>
                                <p>Access your tasks from any device - phone, tablet, or computer - always in sync.</p>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl mb-2">üîí</div>
                                <h4 class="font-semibold mb-1">Secure & Private</h4>
                                <p>Data is stored in your personal Google Drive folder, only you can access it.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="mt-6 pt-4 border-t border-gray-200 text-center text-sm text-gray-600">
                    <p>üí° <strong>Need more help?</strong> Check the <a href="https://developers.google.com/drive/api/quickstart/js" target="_blank" class="text-blue-600 hover:underline">Google Drive API documentation</a> for detailed guides.</p>
                </div>
            </div>
        </div>

        <!-- Task Modal -->
        <div id="taskModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
            <div class="glass-effect rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 id="modalTitle" class="text-2xl font-bold text-gray-700"></h3>
                        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 text-2xl">√ó</button>
                    </div>
                    
                    <!-- Add Task Form -->
                    <div class="mb-6">
                        <div class="flex flex-col gap-3 mb-3">
                            <div class="flex gap-2">
                                <input 
                                    type="text" 
                                    id="newTaskInput" 
                                    placeholder="Add a new task..." 
                                    class="flex-1 px-4 py-2 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-transparent outline-none"
                                    maxlength="50"
                                >
                                <button onclick="addDailyTask()" class="px-4 py-2 bg-gradient-to-r from-pink-300 to-pink-400 hover:from-pink-400 hover:to-pink-500 text-white rounded-lg transition-all duration-200">
                                    ‚ûï
                                </button>
                            </div>
                            <select id="taskPriority" class="px-4 py-2 border border-pink-200 rounded-lg focus:ring-2 focus:ring-pink-300 focus:border-transparent outline-none text-gray-700">
                                <option value="low">üü¢ Low Priority</option>
                                <option value="medium">üü° Medium Priority</option>
                                <option value="high">üî¥ High Priority</option>
                            </select>
                        </div>
                        <div class="text-xs text-gray-500 mb-2">
                            <span id="taskCount">0</span>/10 tasks for this day
                        </div>
                    </div>
                    
                    <!-- Task Filters -->
                    <div class="mb-4">
                        <div class="flex flex-wrap gap-2 mb-3">
                            <button onclick="filterDailyTasks('all')" class="daily-filter-btn active px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200">All</button>
                            <button onclick="filterDailyTasks('pending')" class="daily-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200">Pending</button>
                            <button onclick="filterDailyTasks('completed')" class="daily-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200">Completed</button>
                            <button onclick="filterDailyTasks('high')" class="daily-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200">üî¥ High</button>
                            <button onclick="filterDailyTasks('medium')" class="daily-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200">üü° Medium</button>
                            <button onclick="filterDailyTasks('low')" class="daily-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200">üü¢ Low</button>
                        </div>
                        
                        <!-- Daily Stats -->
                        <div class="grid grid-cols-4 gap-2 text-center text-xs">
                            <div class="bg-purple-50 rounded-lg p-2">
                                <div class="font-bold text-purple-600" id="dailyTotal">0</div>
                                <div class="text-gray-600">Total</div>
                            </div>
                            <div class="bg-orange-50 rounded-lg p-2">
                                <div class="font-bold text-orange-600" id="dailyPending">0</div>
                                <div class="text-gray-600">Pending</div>
                            </div>
                            <div class="bg-green-50 rounded-lg p-2">
                                <div class="font-bold text-green-600" id="dailyCompleted">0</div>
                                <div class="text-gray-600">Done</div>
                            </div>
                            <div class="bg-blue-50 rounded-lg p-2">
                                <div class="font-bold text-blue-600" id="dailyProgress">0%</div>
                                <div class="text-gray-600">Progress</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tasks List -->
                    <div id="dailyTasksList" class="space-y-2">
                        <!-- Daily tasks will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="glass-effect mt-12 border-t-2 border-purple-200">
        <div class="container mx-auto px-4 py-12 max-w-7xl">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                <!-- Company Section -->
                <div class="text-center md:text-left">
                    <div class="mb-4">
                        <h3 class="text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-2 flex items-center justify-center md:justify-start gap-2">
                            üåê PluxCore Technologies
                        </h3>
                        <p class="text-lg text-gray-600 font-semibold mb-2">Innovating Your Digital Future</p>
                        <p class="text-gray-600 text-sm leading-relaxed">
                            Empowering businesses with cutting-edge digital solutions and innovative software.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <p class="text-gray-600 flex items-center justify-center md:justify-start gap-2">
                            üåê Visit: <a href="https://www.pluxcore.com" target="_blank" class="text-blue-500 hover:text-blue-700 font-medium hover:underline transition-colors duration-200">www.pluxcore.com</a>
                        </p>
                    </div>
                </div>
                
                <!-- Developer Section -->
                <div class="text-center">
                    <h4 class="text-lg font-bold text-gray-700 mb-4">Development</h4>
                    <div class="mb-4">
                        <p class="text-gray-600 mb-1 flex items-center justify-center gap-2">
                            üë®‚Äçüíª Developed by
                        </p>
                        <p class="font-bold text-purple-600 text-lg">Roshith Priyadarshana</p>
                        <p class="text-gray-500 text-sm">Full-Stack Developer</p>
                    </div>
                </div>
                
                <!-- Connect Section -->
                <div class="text-center md:text-right">
                    <h4 class="text-lg font-bold text-gray-700 mb-4">Connect</h4>
                    
                    <!-- Quick Links -->
                    <div class="mb-4 space-y-2">
                        <div class="flex items-center justify-center md:justify-end gap-4 text-sm">
                            <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-200 flex items-center gap-1">
                                ‚ùì Help & Support
                            </a>
                            <a href="https://www.pluxcore.com" target="_blank" class="text-gray-600 hover:text-blue-600 transition-colors duration-200 flex items-center gap-1">
                                üåê PluxCore Website
                            </a>
                        </div>
                    </div>
                    
                    <!-- Social Media Icons -->
                    <div class="flex justify-center md:justify-end items-center gap-3 mb-4">
                        <a href="#" target="_blank" class="w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105" title="Facebook">
                            <span class="text-lg">f</span>
                        </a>
                        <a href="#" target="_blank" class="w-10 h-10 bg-sky-500 hover:bg-sky-600 text-white rounded-lg flex items-center justify-center transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105" title="Twitter">
                            <span class="text-lg">ùïè</span>
                        </a>
                        <a href="#" target="_blank" class="w-10 h-10 bg-blue-700 hover:bg-blue-800 text-white rounded-lg flex items-center justify-center transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105" title="LinkedIn">
                            <span class="text-lg">in</span>
                        </a>
                        <a href="#" target="_blank" class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-lg flex items-center justify-center transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105" title="Instagram">
                            <span class="text-lg">üì∑</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Divider -->
            <div class="border-t border-gray-300 pt-6">
                <!-- Copyright -->
                <div class="text-center mb-4">
                    <p class="text-gray-700 font-medium">¬© 2025 PluxCore Technologies. All rights reserved.</p>
                </div>
                
                <!-- App Features -->
                <div class="flex flex-wrap justify-center items-center gap-6 text-sm text-gray-600">
                    <div class="flex items-center gap-2">
                        <span class="text-lg">üóìÔ∏è</span>
                        <span class="font-medium">TaskLoom v1.0</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-lg">üîí</span>
                        <span>Privacy First</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-lg">‚òÅÔ∏è</span>
                        <span>Cloud Sync</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-lg">üì±</span>
                        <span>Responsive</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let currentDate = new Date();
        let monthlyTasks = {};
        let mainTasks = [];
        let monthlyTodoTasks = {}; // Separate storage for monthly to-do list
        let selectedDate = null;
        let isSignedIn = false;
        let gapi_loaded = false;
        let currentDailyFilter = 'all';
        let currentMainFilter = 'all';

        // Google API configuration - DEMO VERSION
        // For production, replace these with your actual Google API credentials
        const CLIENT_ID = '1234567890-abcdefghijklmnopqrstuvwxyz.apps.googleusercontent.com'; 
        const API_KEY = 'AIzaSyDEMO_KEY_REPLACE_WITH_REAL_KEY'; 
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';

        // Initialize the app
        window.onload = function() {
            loadLocalData();
            renderCalendar();
            updateMonthlyStats();
            updateMainTaskStats();
            renderMainTasks();
            renderMonthlyTodoList();
            setTodayDate();
            initializeGoogleAPI();
            initializeTheme();
            updateSettingsInfo();
        };

        // Initialize Google API
        async function initializeGoogleAPI() {
            try {
                await new Promise((resolve) => {
                    gapi.load('auth2:client', resolve);
                });
                
                await gapi.client.init({
                    apiKey: API_KEY,
                    clientId: CLIENT_ID,
                    discoveryDocs: [DISCOVERY_DOC],
                    scope: SCOPES
                });
                
                gapi_loaded = true;
                const authInstance = gapi.auth2.getAuthInstance();
                
                if (authInstance.isSignedIn.get()) {
                    handleSignInSuccess();
                    await loadFromGoogle(); // Auto-load data if already signed in
                }
                
                // Update button text to show API is ready
                document.getElementById('googleSignIn').innerHTML = 'üîó Connect Google Drive';
                
            } catch (error) {
                console.log('Google API initialization failed - using local storage only');
                document.getElementById('googleSignIn').innerHTML = '‚ùå Google Drive Unavailable';
                document.getElementById('googleSignIn').disabled = true;
                document.getElementById('googleSignIn').className = 'px-6 py-3 bg-gray-300 text-gray-500 font-medium rounded-xl cursor-not-allowed';
            }
        }

        // Google Sign In
        async function signIn() {
            if (!gapi_loaded) {
                alert('Google services are not available. Your data will be saved locally.');
                return;
            }
            
            try {
                // Show loading state
                document.getElementById('googleSignIn').innerHTML = '‚è≥ Connecting...';
                document.getElementById('googleSignIn').disabled = true;
                
                const authInstance = gapi.auth2.getAuthInstance();
                await authInstance.signIn();
                handleSignInSuccess();
                
                // Load existing data from Google Drive first
                await loadFromGoogle();
                
                // Then sync current data
                await syncWithGoogle();
                
                // Show success message
                showNotification('‚úÖ Connected to Google Drive successfully!', 'success');
                
            } catch (error) {
                console.error('Sign in failed:', error);
                
                // Reset button state
                document.getElementById('googleSignIn').innerHTML = 'üîó Connect Google Drive';
                document.getElementById('googleSignIn').disabled = false;
                
                if (error.error === 'popup_closed_by_user') {
                    showNotification('‚ö†Ô∏è Sign in was cancelled', 'warning');
                } else {
                    showNotification('‚ùå Sign in failed. Using local storage only.', 'error');
                }
            }
        }

        // Handle successful sign in
        function handleSignInSuccess() {
            const authInstance = gapi.auth2.getAuthInstance();
            const user = authInstance.currentUser.get();
            const profile = user.getBasicProfile();
            
            document.getElementById('googleSignIn').classList.add('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('userName').textContent = profile.getName();
            document.getElementById('userEmail').textContent = profile.getEmail();
            document.getElementById('userPhoto').src = profile.getImageUrl();
            
            // Update settings panel
            updateGoogleStatus(true, profile.getName(), profile.getEmail());
            
            isSignedIn = true;
        }

        // Update Google status in settings
        function updateGoogleStatus(connected, name = '', email = '') {
            const googleStatus = document.getElementById('googleStatus');
            if (connected) {
                googleStatus.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">‚úÖ</span>
                        <div>
                            <div class="font-medium text-green-700">Connected</div>
                            <div class="text-sm text-green-600">${name} (${email})</div>
                        </div>
                    </div>
                `;
                document.getElementById('storageInfo').textContent = 'Google Drive + Local';
            } else {
                googleStatus.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">‚ùå</span>
                        <div>
                            <div class="font-medium text-gray-700">Not Connected</div>
                            <div class="text-sm text-gray-500">Connect to sync across devices</div>
                        </div>
                    </div>
                `;
                document.getElementById('storageInfo').textContent = 'Local Browser';
            }
        }

        // Sign out
        async function signOut() {
            try {
                if (gapi_loaded) {
                    const authInstance = gapi.auth2.getAuthInstance();
                    await authInstance.signOut();
                }
                
                document.getElementById('googleSignIn').classList.remove('hidden');
                document.getElementById('googleSignIn').innerHTML = `
                    <svg class="w-5 h-5" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Connect Google
                `;
                document.getElementById('googleSignIn').disabled = false;
                document.getElementById('userInfo').classList.add('hidden');
                
                // Update settings panel
                updateGoogleStatus(false);
                
                isSignedIn = false;
                showNotification('üëã Signed out successfully', 'success');
                
            } catch (error) {
                console.error('Sign out failed:', error);
                showNotification('‚ö†Ô∏è Sign out failed', 'error');
            }
        }

        // Sync with Google Drive
        async function syncWithGoogle() {
            if (!isSignedIn || !gapi_loaded) {
                showNotification('‚ö†Ô∏è Not connected to Google Drive', 'warning');
                return;
            }
            
            try {
                // Show sync status
                const syncButton = event?.target;
                if (syncButton) {
                    syncButton.innerHTML = '‚è≥ Syncing...';
                    syncButton.disabled = true;
                }
                
                const data = JSON.stringify({
                    monthlyTasks: monthlyTasks,
                    mainTasks: mainTasks,
                    monthlyTodoTasks: monthlyTodoTasks,
                    lastSync: new Date().toISOString()
                });
                
                const metadata = {
                    name: 'taskloom-data.json',
                    parents: ['appDataFolder']
                };
                
                // Check if file exists
                const response = await gapi.client.drive.files.list({
                    q: "name='taskloom-data.json' and parents in 'appDataFolder'",
                    spaces: 'appDataFolder'
                });
                
                const boundary = '-------314159265358979323846';
                const delimiter = "\r\n--" + boundary + "\r\n";
                const close_delim = "\r\n--" + boundary + "--";
                
                const body = delimiter +
                    'Content-Type: application/json\r\n\r\n' +
                    JSON.stringify(metadata) +
                    delimiter +
                    'Content-Type: application/json\r\n\r\n' +
                    data +
                    close_delim;
                
                if (response.result.files.length > 0) {
                    // Update existing file
                    await gapi.client.request({
                        path: `https://www.googleapis.com/upload/drive/v3/files/${response.result.files[0].id}`,
                        method: 'PATCH',
                        params: { uploadType: 'multipart' },
                        headers: { 'Content-Type': 'multipart/related; boundary="' + boundary + '"' },
                        body: body
                    });
                } else {
                    // Create new file
                    await gapi.client.request({
                        path: 'https://www.googleapis.com/upload/drive/v3/files',
                        method: 'POST',
                        params: { uploadType: 'multipart' },
                        headers: { 'Content-Type': 'multipart/related; boundary="' + boundary + '"' },
                        body: body
                    });
                }
                
                // Reset sync button
                if (syncButton) {
                    syncButton.innerHTML = 'üîÑ Sync';
                    syncButton.disabled = false;
                }
                
                // Update last sync time
                localStorage.setItem('lastSyncTime', new Date().toISOString());
                updateSettingsInfo();
                
                showNotification('‚úÖ Data synced to Google Drive!', 'success');
                
            } catch (error) {
                console.error('Sync failed:', error);
                
                // Reset sync button
                if (syncButton) {
                    syncButton.innerHTML = 'üîÑ Sync';
                    syncButton.disabled = false;
                }
                
                showNotification('‚ùå Sync failed. Check your connection.', 'error');
            }
        }

        // Load data from Google Drive
        async function loadFromGoogle() {
            if (!isSignedIn || !gapi_loaded) return;
            
            try {
                const response = await gapi.client.drive.files.list({
                    q: "name='taskloom-data.json' and parents in 'appDataFolder'",
                    spaces: 'appDataFolder'
                });
                
                if (response.result.files.length > 0) {
                    const fileId = response.result.files[0].id;
                    const file = await gapi.client.drive.files.get({
                        fileId: fileId,
                        alt: 'media'
                    });
                    
                    const loadedData = JSON.parse(file.body);
                    
                    // Merge data instead of overwriting to preserve local changes
                    if (loadedData.monthlyTasks) {
                        monthlyTasks = { ...monthlyTasks, ...loadedData.monthlyTasks };
                    }
                    if (loadedData.mainTasks) {
                        // Merge main tasks by ID to avoid duplicates
                        const existingIds = new Set(mainTasks.map(t => t.id));
                        const newTasks = loadedData.mainTasks.filter(t => !existingIds.has(t.id));
                        mainTasks = [...mainTasks, ...newTasks];
                    }
                    if (loadedData.monthlyTodoTasks) {
                        monthlyTodoTasks = { ...monthlyTodoTasks, ...loadedData.monthlyTodoTasks };
                    }
                    
                    saveLocalData();
                    renderCalendar();
                    updateMonthlyStats();
                    updateMainTaskStats();
                    renderMainTasks();
                    renderMonthlyTodoList();
                    
                    const lastSync = loadedData.lastSync ? new Date(loadedData.lastSync).toLocaleString() : 'Unknown';
                    showNotification(`üì• Data loaded from Google Drive (Last sync: ${lastSync})`, 'success');
                } else {
                    showNotification('üìÅ No backup found in Google Drive', 'info');
                }
            } catch (error) {
                console.error('Load from Google failed:', error);
                showNotification('‚ùå Failed to load from Google Drive', 'error');
            }
        }

        // Get date key for storage
        function getDateKey(date) {
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        }

        // Get current month key
        function getMonthKey() {
            return `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
        }

        // Render calendar
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Update month title
            document.getElementById('currentMonth').textContent = 
                currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';
            
            // Add empty cells for days before month starts
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day bg-gray-50 rounded-lg opacity-50';
                calendarGrid.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateKey = getDateKey(date);
                const dayTasks = monthlyTasks[dateKey] || [];
                const isToday = date.toDateString() === new Date().toDateString();
                
                const dayElement = document.createElement('div');
                dayElement.className = `calendar-day bg-white rounded-lg border-2 cursor-pointer transition-all duration-200 p-2 ${
                    isToday ? 'border-pink-300 bg-pink-50' : 'border-gray-200 hover:border-purple-300'
                }`;
                
                dayElement.onclick = () => openDayModal(date);
                
                // Day number
                const dayNumber = document.createElement('div');
                dayNumber.className = `font-bold text-lg mb-1 ${isToday ? 'text-pink-600' : 'text-gray-700'}`;
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);
                
                // Task indicators
                const taskIndicators = document.createElement('div');
                taskIndicators.className = 'flex flex-wrap gap-1';
                
                dayTasks.slice(0, 8).forEach(task => {
                    const dot = document.createElement('div');
                    let dotColor = 'bg-pink-400';
                    
                    if (task.completed) {
                        dotColor = 'bg-green-400';
                    } else {
                        switch(task.priority) {
                            case 'high': dotColor = 'bg-red-400'; break;
                            case 'medium': dotColor = 'bg-yellow-400'; break;
                            case 'low': dotColor = 'bg-green-300'; break;
                        }
                    }
                    
                    dot.className = `task-dot ${dotColor}`;
                    dot.title = `${task.text} (${task.priority} priority)`;
                    taskIndicators.appendChild(dot);
                });
                
                if (dayTasks.length > 8) {
                    const moreDot = document.createElement('div');
                    moreDot.className = 'text-xs text-gray-500 font-medium';
                    moreDot.textContent = `+${dayTasks.length - 8}`;
                    taskIndicators.appendChild(moreDot);
                }
                
                dayElement.appendChild(taskIndicators);
                
                // Task count
                if (dayTasks.length > 0) {
                    const taskCount = document.createElement('div');
                    taskCount.className = 'text-xs text-gray-500 mt-1';
                    const completed = dayTasks.filter(t => t.completed).length;
                    taskCount.textContent = `${completed}/${dayTasks.length}`;
                    dayElement.appendChild(taskCount);
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        // Open day modal
        function openDayModal(date) {
            selectedDate = date;
            currentDailyFilter = 'all';
            
            document.getElementById('modalTitle').textContent = 
                date.toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            
            document.getElementById('taskModal').classList.remove('hidden');
            document.getElementById('taskModal').classList.add('flex');
            
            // Reset filter buttons
            document.querySelectorAll('.daily-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.daily-filter-btn').classList.add('active');
            
            renderDailyTasks();
            updateTaskCount();
            updateDailyStats();
        }

        // Close modal
        function closeModal() {
            document.getElementById('taskModal').classList.add('hidden');
            document.getElementById('taskModal').classList.remove('flex');
            selectedDate = null;
        }

        // Add daily task
        function addDailyTask() {
            if (!selectedDate) return;
            
            const input = document.getElementById('newTaskInput');
            const prioritySelect = document.getElementById('taskPriority');
            const taskText = input.value.trim();
            
            if (!taskText) {
                alert('Please enter a task!');
                return;
            }
            
            const dateKey = getDateKey(selectedDate);
            if (!monthlyTasks[dateKey]) {
                monthlyTasks[dateKey] = [];
            }
            
            if (monthlyTasks[dateKey].length >= 10) {
                alert('Maximum 10 tasks per day!');
                return;
            }
            
            const task = {
                id: Date.now(),
                text: taskText,
                priority: prioritySelect.value,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            monthlyTasks[dateKey].push(task);
            input.value = '';
            prioritySelect.value = 'low';
            
            saveData();
            renderDailyTasks();
            renderCalendar();
            updateMonthlyStats();
            updateTaskCount();
            updateDailyStats();
        }

        // Toggle daily task
        function toggleDailyTask(taskId) {
            if (!selectedDate) return;
            
            const dateKey = getDateKey(selectedDate);
            const tasks = monthlyTasks[dateKey] || [];
            
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveData();
                renderDailyTasks();
                renderCalendar();
                updateMonthlyStats();
                updateDailyStats();
            }
        }

        // Delete daily task
        function deleteDailyTask(taskId) {
            if (!selectedDate) return;
            
            const dateKey = getDateKey(selectedDate);
            if (monthlyTasks[dateKey]) {
                monthlyTasks[dateKey] = monthlyTasks[dateKey].filter(t => t.id !== taskId);
                if (monthlyTasks[dateKey].length === 0) {
                    delete monthlyTasks[dateKey];
                }
                
                saveData();
                renderDailyTasks();
                renderCalendar();
                updateMonthlyStats();
                updateTaskCount();
                updateDailyStats();
            }
        }

        // Filter daily tasks
        function filterDailyTasks(filter) {
            currentDailyFilter = filter;
            
            // Update filter button styles
            document.querySelectorAll('.daily-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
            renderDailyTasks();
        }

        // Render daily tasks
        function renderDailyTasks() {
            if (!selectedDate) return;
            
            const dateKey = getDateKey(selectedDate);
            let tasks = monthlyTasks[dateKey] || [];
            const tasksList = document.getElementById('dailyTasksList');
            
            // Apply filter
            let filteredTasks = tasks;
            switch(currentDailyFilter) {
                case 'pending':
                    filteredTasks = tasks.filter(task => !task.completed);
                    break;
                case 'completed':
                    filteredTasks = tasks.filter(task => task.completed);
                    break;
                case 'high':
                    filteredTasks = tasks.filter(task => task.priority === 'high');
                    break;
                case 'medium':
                    filteredTasks = tasks.filter(task => task.priority === 'medium');
                    break;
                case 'low':
                    filteredTasks = tasks.filter(task => task.priority === 'low');
                    break;
            }
            
            if (filteredTasks.length === 0) {
                const message = tasks.length === 0 ? 'No tasks for this day yet!' : `No ${currentDailyFilter} tasks found.`;
                tasksList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <div class="text-4xl mb-2">üìù</div>
                        <p>${message}</p>
                    </div>
                `;
                return;
            }
            
            const priorityColors = {
                low: 'from-green-50 to-green-100 border-green-200',
                medium: 'from-yellow-50 to-yellow-100 border-yellow-200',
                high: 'from-red-50 to-red-100 border-red-200'
            };
            
            const priorityIcons = {
                low: 'üü¢',
                medium: 'üü°',
                high: 'üî¥'
            };
            
            tasksList.innerHTML = filteredTasks.map(task => `
                <div class="flex items-center gap-3 p-3 bg-gradient-to-r ${priorityColors[task.priority]} border rounded-lg slide-in">
                    <input 
                        type="checkbox" 
                        ${task.completed ? 'checked' : ''} 
                        onchange="toggleDailyTask(${task.id})"
                        class="w-4 h-4 text-pink-500 rounded focus:ring-pink-300"
                    >
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            <span class="${task.completed ? 'line-through text-gray-500' : 'text-gray-700'}">${task.text}</span>
                            <span class="text-sm">${priorityIcons[task.priority]}</span>
                        </div>
                        <div class="text-xs text-gray-500 mt-1">
                            ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)} Priority
                        </div>
                    </div>
                    <button 
                        onclick="deleteDailyTask(${task.id})" 
                        class="text-red-400 hover:text-red-600 p-1 rounded transition-colors duration-200"
                        title="Delete task"
                    >
                        üóëÔ∏è
                    </button>
                </div>
            `).join('');
        }

        // Update task count
        function updateTaskCount() {
            if (!selectedDate) return;
            
            const dateKey = getDateKey(selectedDate);
            const tasks = monthlyTasks[dateKey] || [];
            document.getElementById('taskCount').textContent = tasks.length;
        }

        // Update daily stats
        function updateDailyStats() {
            if (!selectedDate) return;
            
            const dateKey = getDateKey(selectedDate);
            const tasks = monthlyTasks[dateKey] || [];
            
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pending = total - completed;
            const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('dailyTotal').textContent = total;
            document.getElementById('dailyPending').textContent = pending;
            document.getElementById('dailyCompleted').textContent = completed;
            document.getElementById('dailyProgress').textContent = progress + '%';
        }

        // Update monthly stats
        function updateMonthlyStats() {
            const monthKey = getMonthKey();
            let totalTasks = 0;
            let completedTasks = 0;
            let activeDays = 0;
            
            Object.keys(monthlyTasks).forEach(dateKey => {
                if (dateKey.startsWith(monthKey)) {
                    const dayTasks = monthlyTasks[dateKey];
                    if (dayTasks.length > 0) {
                        activeDays++;
                        totalTasks += dayTasks.length;
                        completedTasks += dayTasks.filter(t => t.completed).length;
                    }
                }
            });
            
            const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            document.getElementById('monthlyTotal').textContent = totalTasks;
            document.getElementById('monthlyCompleted').textContent = completedTasks;
            document.getElementById('activeDays').textContent = activeDays;
            document.getElementById('completionRate').textContent = completionRate + '%';
        }

        // Navigation
        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
            updateMonthlyStats();
            renderMonthlyTodoList();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
            updateMonthlyStats();
            renderMonthlyTodoList();
        }

        // Data management
        function saveData() {
            saveLocalData();
            if (isSignedIn) {
                syncWithGoogle();
            }
        }

        function saveLocalData() {
            localStorage.setItem('taskLoomMonthlyTasks', JSON.stringify(monthlyTasks));
            localStorage.setItem('taskLoomMainTasks', JSON.stringify(mainTasks));
            localStorage.setItem('taskLoomMonthlyTodo', JSON.stringify(monthlyTodoTasks));
        }

        function loadLocalData() {
            const savedMonthly = localStorage.getItem('taskLoomMonthlyTasks');
            if (savedMonthly) {
                monthlyTasks = JSON.parse(savedMonthly);
            }
            
            const savedMain = localStorage.getItem('taskLoomMainTasks');
            if (savedMain) {
                mainTasks = JSON.parse(savedMain);
            }
            
            const savedMonthlyTodo = localStorage.getItem('taskLoomMonthlyTodo');
            if (savedMonthlyTodo) {
                monthlyTodoTasks = JSON.parse(savedMonthlyTodo);
            }
        }

        // Allow Enter key to add task
        document.getElementById('newTaskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addDailyTask();
            }
        });

        // Close modal when clicking outside
        document.getElementById('taskModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Set today's date as default
        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('mainTaskDate').value = today;
        }

        // Add main task
        function addMainTask() {
            const input = document.getElementById('mainTaskInput');
            const prioritySelect = document.getElementById('mainTaskPriority');
            const dateInput = document.getElementById('mainTaskDate');
            
            const taskText = input.value.trim();
            const priority = prioritySelect.value;
            const dueDate = dateInput.value;
            
            if (!taskText) {
                alert('Please enter a task!');
                return;
            }
            
            if (!dueDate) {
                alert('Please select a due date!');
                return;
            }
            
            const task = {
                id: Date.now(),
                text: taskText,
                priority: priority,
                dueDate: dueDate,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            mainTasks.push(task);
            
            input.value = '';
            prioritySelect.value = 'low';
            setTodayDate();
            
            saveData();
            renderMainTasks();
            updateMainTaskStats();
        }

        // Toggle main task
        function toggleMainTask(taskId) {
            const task = mainTasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                
                saveData();
                renderMainTasks();
                updateMainTaskStats();
            }
        }

        // Delete main task
        function deleteMainTask(taskId) {
            const taskIndex = mainTasks.findIndex(t => t.id === taskId);
            if (taskIndex > -1) {
                mainTasks.splice(taskIndex, 1);
                
                saveData();
                renderMainTasks();
                updateMainTaskStats();
            }
        }

        // Filter main tasks
        function filterMainTasks(filter) {
            currentMainFilter = filter;
            
            // Update filter button styles
            document.querySelectorAll('.main-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
            renderMainTasks();
        }

        // Render main tasks
        function renderMainTasks() {
            const tasksList = document.getElementById('mainTasksList');
            let filteredTasks = mainTasks;
            
            // Apply filter
            const today = new Date().toISOString().split('T')[0];
            
            switch(currentMainFilter) {
                case 'pending':
                    filteredTasks = mainTasks.filter(task => !task.completed);
                    break;
                case 'completed':
                    filteredTasks = mainTasks.filter(task => task.completed);
                    break;
                case 'high':
                    filteredTasks = mainTasks.filter(task => task.priority === 'high');
                    break;
                case 'medium':
                    filteredTasks = mainTasks.filter(task => task.priority === 'medium');
                    break;
                case 'low':
                    filteredTasks = mainTasks.filter(task => task.priority === 'low');
                    break;
                case 'today':
                    filteredTasks = mainTasks.filter(task => task.dueDate === today);
                    break;
            }
            
            // Sort by priority and due date
            filteredTasks.sort((a, b) => {
                const priorityOrder = { high: 3, medium: 2, low: 1 };
                if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                    return priorityOrder[b.priority] - priorityOrder[a.priority];
                }
                return new Date(a.dueDate) - new Date(b.dueDate);
            });
            
            if (filteredTasks.length === 0) {
                const message = mainTasks.length === 0 ? 'No tasks created yet!' : `No ${currentMainFilter} tasks found.`;
                tasksList.innerHTML = `
                    <div class="text-center text-gray-500 py-12">
                        <div class="text-6xl mb-4">üìù</div>
                        <p class="text-xl">${message}</p>
                        <p class="text-sm mt-2">Add your first task using the form above!</p>
                    </div>
                `;
                return;
            }
            
            const priorityColors = {
                low: 'from-green-50 to-green-100 border-green-200',
                medium: 'from-yellow-50 to-yellow-100 border-yellow-200',
                high: 'from-red-50 to-red-100 border-red-200'
            };
            
            const priorityIcons = {
                low: 'üü¢',
                medium: 'üü°',
                high: 'üî¥'
            };
            
            tasksList.innerHTML = filteredTasks.map(task => {
                const dueDate = new Date(task.dueDate);
                const today = new Date();
                const isOverdue = dueDate < today && !task.completed;
                const isToday = task.dueDate === today.toISOString().split('T')[0];
                
                return `
                    <div class="flex items-center gap-4 p-4 bg-gradient-to-r ${priorityColors[task.priority]} border rounded-xl slide-in ${isOverdue ? 'ring-2 ring-red-300' : ''}">
                        <input 
                            type="checkbox" 
                            ${task.completed ? 'checked' : ''} 
                            onchange="toggleMainTask(${task.id})"
                            class="w-5 h-5 text-pink-500 rounded focus:ring-pink-300"
                        >
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-1">
                                <span class="text-lg ${task.completed ? 'line-through text-gray-500' : 'text-gray-800 font-medium'}">${task.text}</span>
                                <span class="text-lg">${priorityIcons[task.priority]}</span>
                                ${isOverdue ? '<span class="text-red-500 text-sm font-bold">‚ö†Ô∏è OVERDUE</span>' : ''}
                                ${isToday ? '<span class="text-blue-500 text-sm font-bold">üìÖ TODAY</span>' : ''}
                            </div>
                            <div class="flex items-center gap-4 text-sm text-gray-600">
                                <span class="capitalize font-medium">${task.priority} Priority</span>
                                <span>Due: ${dueDate.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}</span>
                                <span>Created: ${new Date(task.createdAt).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>
                            </div>
                        </div>
                        <button 
                            onclick="deleteMainTask(${task.id})" 
                            class="text-red-400 hover:text-red-600 p-2 rounded-lg transition-colors duration-200 hover:bg-red-50"
                            title="Delete task"
                        >
                            üóëÔ∏è
                        </button>
                    </div>
                `;
            }).join('');
        }

        // Update main task statistics
        function updateMainTaskStats() {
            const total = mainTasks.length;
            const completed = mainTasks.filter(t => t.completed).length;
            const pending = total - completed;
            const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            // Overall stats
            document.getElementById('mainTotalTasks').textContent = total;
            document.getElementById('mainPendingTasks').textContent = pending;
            document.getElementById('mainCompletedTasks').textContent = completed;
            document.getElementById('mainProgressRate').textContent = progress + '%';
        }

        // Add monthly todo task
        function addMonthlyTask() {
            const input = document.getElementById('monthlyTaskInput');
            const taskText = input.value.trim();
            
            if (!taskText) {
                alert('Please enter a task!');
                return;
            }
            
            const monthKey = getMonthKey();
            if (!monthlyTodoTasks[monthKey]) {
                monthlyTodoTasks[monthKey] = [];
            }
            
            const task = {
                id: Date.now(),
                text: taskText,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            monthlyTodoTasks[monthKey].push(task);
            input.value = '';
            
            saveData();
            renderMonthlyTodoList();
        }

        // Toggle monthly todo task
        function toggleMonthlyTask(taskId) {
            const monthKey = getMonthKey();
            const tasks = monthlyTodoTasks[monthKey] || [];
            
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveData();
                renderMonthlyTodoList();
            }
        }

        // Delete monthly todo task
        function deleteMonthlyTask(taskId) {
            const monthKey = getMonthKey();
            if (monthlyTodoTasks[monthKey]) {
                monthlyTodoTasks[monthKey] = monthlyTodoTasks[monthKey].filter(t => t.id !== taskId);
                if (monthlyTodoTasks[monthKey].length === 0) {
                    delete monthlyTodoTasks[monthKey];
                }
                
                saveData();
                renderMonthlyTodoList();
            }
        }

        // Render monthly to-do list
        function renderMonthlyTodoList() {
            const monthKey = getMonthKey();
            const monthlyTodoList = document.getElementById('monthlyTodoList');
            const tasks = monthlyTodoTasks[monthKey] || [];
            
            if (tasks.length === 0) {
                monthlyTodoList.innerHTML = `
                    <div class="text-center text-gray-500 py-6">
                        <div class="text-3xl mb-2">üìù</div>
                        <p class="text-sm">No monthly tasks yet!</p>
                        <p class="text-xs mt-1">Add tasks above</p>
                    </div>
                `;
                return;
            }
            
            monthlyTodoList.innerHTML = tasks.map(task => `
                <div class="flex items-center gap-3 p-3 bg-white bg-opacity-60 rounded-lg border border-gray-200 hover:bg-opacity-80 transition-all duration-200">
                    <button 
                        onclick="toggleMonthlyTask(${task.id})"
                        class="w-5 h-5 rounded border-2 border-pink-300 flex items-center justify-center transition-all duration-200 ${
                            task.completed ? 'bg-pink-400 text-white' : 'hover:bg-pink-50'
                        }"
                    >
                        ${task.completed ? '‚úì' : ''}
                    </button>
                    <div class="flex-1 min-w-0">
                        <span class="text-sm ${task.completed ? 'line-through text-gray-500' : 'text-gray-700'}">${task.text}</span>
                    </div>
                    <button 
                        onclick="deleteMonthlyTask(${task.id})" 
                        class="text-red-400 hover:text-red-600 p-1 rounded transition-colors duration-200"
                        title="Delete task"
                    >
                        üóëÔ∏è
                    </button>
                </div>
            `).join('');
        }

        // Allow Enter key to add main task
        document.getElementById('mainTaskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addMainTask();
            }
        });

        // Allow Enter key to add monthly task
        document.getElementById('monthlyTaskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addMonthlyTask();
            }
        });

        // Toggle help panel
        function toggleHelpPanel() {
            const helpPanel = document.getElementById('helpPanel');
            const helpButton = document.getElementById('helpButton');
            
            if (helpPanel.classList.contains('translate-y-full')) {
                // Show panel
                helpPanel.classList.remove('translate-y-full');
                helpButton.innerHTML = `
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                `;
            } else {
                // Hide panel
                helpPanel.classList.add('translate-y-full');
                helpButton.innerHTML = `
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                `;
            }
        }

        // Theme Management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('taskLoomTheme') || 'light';
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
                updateThemeToggle(true);
            }
        }

        function toggleTheme() {
            const isDark = document.documentElement.classList.contains('dark');
            
            if (isDark) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('taskLoomTheme', 'light');
                updateThemeToggle(false);
                showNotification('‚òÄÔ∏è Switched to light mode', 'info');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('taskLoomTheme', 'dark');
                updateThemeToggle(true);
                showNotification('üåô Switched to dark mode', 'info');
            }
        }

        function updateThemeToggle(isDark) {
            const themeButton = document.getElementById('themeToggle');
            const themeSwitch = document.getElementById('themeToggleSwitch');
            const themeIndicator = document.getElementById('themeToggleIndicator');
            
            if (isDark) {
                themeButton.innerHTML = '‚òÄÔ∏è';
                themeSwitch.classList.add('bg-purple-600');
                themeSwitch.classList.remove('bg-gray-200');
                themeIndicator.classList.add('translate-x-6');
                themeIndicator.classList.remove('translate-x-1');
            } else {
                themeButton.innerHTML = 'üåô';
                themeSwitch.classList.remove('bg-purple-600');
                themeSwitch.classList.add('bg-gray-200');
                themeIndicator.classList.remove('translate-x-6');
                themeIndicator.classList.add('translate-x-1');
            }
        }

        // Settings Panel
        function toggleSettings() {
            const settingsPanel = document.getElementById('settingsPanel');
            
            if (settingsPanel.classList.contains('translate-x-full')) {
                settingsPanel.classList.remove('translate-x-full');
                updateSettingsInfo();
            } else {
                settingsPanel.classList.add('translate-x-full');
            }
        }

        function updateSettingsInfo() {
            // Update total tasks count
            const totalTasks = mainTasks.length + Object.values(monthlyTasks).flat().length + Object.values(monthlyTodoTasks).flat().length;
            document.getElementById('totalTasksCount').textContent = totalTasks;
            
            // Update last sync time
            const lastSync = localStorage.getItem('lastSyncTime');
            if (lastSync) {
                document.getElementById('lastSyncTime').textContent = new Date(lastSync).toLocaleString();
            }
        }

        // Data Management
        function exportData() {
            const data = {
                monthlyTasks: monthlyTasks,
                mainTasks: mainTasks,
                monthlyTodoTasks: monthlyTodoTasks,
                exportDate: new Date().toISOString(),
                version: '2.0.0'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `taskloom-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showNotification('üì§ Data exported successfully!', 'success');
        }

        function importData() {
            const file = document.getElementById('importFile').files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Validate data structure
                    if (!importedData.monthlyTasks && !importedData.mainTasks && !importedData.monthlyTodoTasks) {
                        throw new Error('Invalid data format');
                    }
                    
                    // Merge imported data
                    if (importedData.monthlyTasks) {
                        monthlyTasks = { ...monthlyTasks, ...importedData.monthlyTasks };
                    }
                    if (importedData.mainTasks) {
                        // Merge main tasks by ID to avoid duplicates
                        const existingIds = new Set(mainTasks.map(t => t.id));
                        const newTasks = importedData.mainTasks.filter(t => !existingIds.has(t.id));
                        mainTasks = [...mainTasks, ...newTasks];
                    }
                    if (importedData.monthlyTodoTasks) {
                        monthlyTodoTasks = { ...monthlyTodoTasks, ...importedData.monthlyTodoTasks };
                    }
                    
                    saveData();
                    renderCalendar();
                    updateMonthlyStats();
                    updateMainTaskStats();
                    renderMainTasks();
                    renderMonthlyTodoList();
                    updateSettingsInfo();
                    
                    showNotification('üì• Data imported successfully!', 'success');
                    
                } catch (error) {
                    console.error('Import failed:', error);
                    showNotification('‚ùå Import failed. Please check the file format.', 'error');
                }
            };
            
            reader.readAsText(file);
            // Reset file input
            document.getElementById('importFile').value = '';
        }

        function clearAllData() {
            if (!confirm('‚ö†Ô∏è Are you sure you want to delete ALL tasks? This action cannot be undone!')) {
                return;
            }
            
            monthlyTasks = {};
            mainTasks = [];
            monthlyTodoTasks = {};
            
            saveData();
            renderCalendar();
            updateMonthlyStats();
            updateMainTaskStats();
            renderMainTasks();
            renderMonthlyTodoList();
            updateSettingsInfo();
            
            showNotification('üóëÔ∏è All data cleared successfully!', 'success');
        }

        // Quick Actions
        function goToToday() {
            currentDate = new Date();
            renderCalendar();
            updateMonthlyStats();
            renderMonthlyTodoList();
            showNotification('üìÖ Jumped to current month!', 'info');
            
            // Close settings panel
            document.getElementById('settingsPanel').classList.add('translate-x-full');
        }

        function showStats() {
            const totalTasks = mainTasks.length + Object.values(monthlyTasks).flat().length + Object.values(monthlyTodoTasks).flat().length;
            const completedTasks = mainTasks.filter(t => t.completed).length + 
                                 Object.values(monthlyTasks).flat().filter(t => t.completed).length + 
                                 Object.values(monthlyTodoTasks).flat().filter(t => t.completed).length;
            
            const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            alert(`üìä Task Statistics:\n\n` +
                  `Total Tasks: ${totalTasks}\n` +
                  `Completed: ${completedTasks}\n` +
                  `Pending: ${totalTasks - completedTasks}\n` +
                  `Completion Rate: ${completionRate}%\n\n` +
                  `Main Tasks: ${mainTasks.length}\n` +
                  `Daily Tasks: ${Object.values(monthlyTasks).flat().length}\n` +
                  `Monthly Tasks: ${Object.values(monthlyTodoTasks).flat().length}`);
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg max-w-sm transition-all duration-300 transform translate-x-full`;
            
            // Set colors based on type
            switch(type) {
                case 'success':
                    notification.className += ' bg-green-500 text-white';
                    break;
                case 'error':
                    notification.className += ' bg-red-500 text-white';
                    break;
                case 'warning':
                    notification.className += ' bg-yellow-500 text-white';
                    break;
                case 'info':
                default:
                    notification.className += ' bg-blue-500 text-white';
                    break;
            }
            
            notification.innerHTML = `
                <div class="flex items-center justify-between gap-3">
                    <span class="text-sm font-medium">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-white hover:text-gray-200 font-bold text-lg">√ó</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => notification.remove(), 300);
                }
            }, 5000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96cdd183951092f5',t:'MTc1NDgxMTM0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
